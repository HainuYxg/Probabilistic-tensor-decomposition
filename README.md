# TSP2_Demo
# Demo of Probabilistic Tensor CPD with Orthogonal Factors

## Desription

This demo demonstrates how the probabilistic tensor CPD algorithm is run to recover the latent factor matrices, with inherited merits in orthogonality structure preservation, automatic rank determination and outlier removal. 

In particular, a $12 \times 12 \times 12$ complex-valued tensor with Rank $5$ and one orthogonal factor is genenrated by calling function as follows.

```matlab
[X, factor_cell] = tensor_generation(dim_list, num_of_orthogonal, tensor_rank); 
%% Arguments:
% dim_list = [12,12,12]; %specify the dimension of each tensor mode
% num_of_orthogonal = 1; % 1 factor matrix is asssumed to be orthogonal 
% tensor_rank = 5; % tensor rank is 5
%% Outputs:
% X is the sythetic complex-valued tensor 
% factor_cell{i} is the i^{th} factor matrix 
```

Then, the Gausstian noise tensor  is generated by calling function:

```matlab
W = noise_generation(SNR, X);
%% Arguments:
% SNR = 20; % the signal-to-noise ratio is set as 20dB
% X is the low-rank signal tensor
%% Outputs:
% W is the noise tensor
```

If there exists outliers, e.g., Bernulli-Gaussian outliers, they can be generated by calling function:

```matlab
E = BG_generation(sizeE, power, ratio);
%% Arguments:
% sizeE = size(X); %The dimension of outlier tensor is set to be the same as the signal tensor X 
% power = 100; % The power of outliers is set to be 100
% ratio = 0.05; % The ratio of outliers is 5%. If there is no outlier, ratio can be set to be 0
```

Finally, the observation tensor is 

```matlab
Y = X + W + E;
```

Our algorithm, labeled as VBTCPDO, is to extract the latent signal tensor X with associated factor matrices in factor_cell from the corrupted data tensor Y, without knowledge of tensor rank R. By calling our algorithm as follows, the desired quantities are obtained. 

```matlab
learning_results = VBTCPDO(Y, num_of_orthogonal);
%% Arguments:
% Y is the obsevation data tensor 
% num_of_orthogonal is the number of orthogonal factors being known
%% Outputs:
% learning_results is a structure containing:
% learning_results.X % the recovered latent signal tensor X
% learning_results.factor_cell % the recovered latent factor matrices 
% learning_results.E = E % the estimated outlier tensor
% learning_results.R = R % the estimated tensor rank
```

Comments:

This is just a demo example on the usage of VBTCPDO algorithm. For the detaied applications, the best performance might be obtained by combining data preprocessing and parameters tuning. 

## Reference

Lei Cheng, Yik-Chung Wu, and H. Vincent Poor, "Probabilistic Tensor Canonical Polyadic Decomposition With Orthogonal Factors," IEEE Trans. on Signal Processing, Vol. 65, no. 3, pp. 663-676, Feb 2017.

